<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="quchong.css"  type="text/CSS">
    <script src="quchong.js"  type="text/JavaScript"></script>
    <title>Excel数据去重工具</title>
    <style>
    </style>
</head>
<body>
    <div id="alertMessage" class="alert-message"></div>
    <div class="header-nav">
        <div class="title">
            <img src="/YH.png">
            蒙阴县旧寨乡卫生院数据去重工具
        </div>
        <div class="nav-buttons">
            <button class="nav-btn active" id="uploadPageBtn">文件上传</button>
            <button class="nav-btn" id="resultPageBtn">处理结果</button>
        </div>
    </div>
    <div class="page-container">
        <div class="page active" id="uploadPage">
            <h2>文件上传与处置</h2>
            <div class="form-group">
                <label for="excelFile">1. 上传Excel文件（支持.xlsx/.xls格式）</label>
                <input type="file" id="excelFile" accept=".xlsx,.xls">
                <div class="tip">提示：仅支持Excel 2007+(.xlsx)和Excel 97-2003(.xls)格式</div>
            </div>

            <div class="form-group">
                <label for="startColumn">2. 选择数据源起始列（数据范围开始）</label>
                <select id="startColumn" disabled>
                    <option value="">请先上传Excel文件</option>
                </select>
            </div>

            <div class="form-group">
                <label for="endColumn">3. 选择数据源结束列（数据范围结束）</label>
                <select id="endColumn" disabled>
                    <option value="">请先上传Excel文件</option>
                </select>
            </div>

            <div class="form-group">
                <label for="checkColumn">4. 选择查重列（根据该列去重，保留唯一值）</label>
                <select id="checkColumn" disabled>
                    <option value="">请先上传Excel文件</option>
                </select>
                <div class="tip">提示：去重后将保留该列首次出现的值，并关联对应行的其他列内容</div>
            </div>

            <div class="btn-group">
                <button class="btn" id="uploadBtn" disabled>解析文件</button>
                <button class="btn" id="confirmBtn" disabled>执行去重</button>
            </div>
        </div>
        <div class="page" id="resultPage">
            <div class="result-header">
                <h2>去重结果</h2>
                <button class="export-btn" id="exportResultBtn" disabled>导出</button>
            </div>

            <div class="table-wrapper">
                <table id="resultTable">
                    <thead id="tableHeader"></thead>
                    <tbody id="tableBody"></tbody>
                </table>
            </div>
        </div>
    </div>
    <div>
        <div class="footer"> © 2026 蒙阴县旧寨乡卫生院 |  精准治理医疗数据 · 高效服务基层民生</div>
    </div>
</body>

</html>

